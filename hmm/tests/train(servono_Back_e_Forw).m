A = [0.5,0.5,0; 0,0.5,0.5; 0,0,1]
B = [1/3,1/3,1/3; 1/3,1/3,1/3; 1/3,1/3,1/3]
a1 = A(:,1)
a2 = A(:,2)
a3 = A(:,3)
alpha1 = [1/3,0,0]'
x = [0,0,0,0]
alpha2 = [ a1'*alpha1*1/3, a2'*alpha1*1/3, a3'*alpha1*1/3 ]'
alpha3 = [ a1'*alpha2*1/3, a2'*alpha2*1/3, a3'*alpha2*1/3 ]'
alpha4 = [ a1'*alpha3*1/3, a2'*alpha3*1/3, a3'*alpha3*1/3 ]'
alpha = [alpha1, alpha2, alpha3, alpha4]
beta4 = [1,1,1,]'
beta3 = [(beta4(1)*a1(1)*1/3+beta4(2)*a2(1)*1/3+beta4(3)*a3(1)*1/3), (beta4(1)*a1(2)*1/3+beta4(2)*a2(2)*1/3+beta4(3)*a3(2)*1/3), (beta4(1)*a1(3)*1/3+beta4(2)*a2(3)*1/3+beta4(3)*a3(3)*1/3)]'
beta3 = [1,1,1,]'
beta2 = [(beta3(1)*a1(1)*1/3+beta3(2)*a2(1)*1/3+beta3(3)*a3(1)*1/3), (beta3(1)*a1(2)*1/3+beta3(2)*a2(2)*1/3+beta3(3)*a3(2)*1/3), (beta3(1)*a1(3)*1/3+beta3(2)*a2(3)*1/3+beta3(3)*a3(3)*1/3)]'
beta4 = [1,1,1,]'
beta3 = [(beta4(1)*a1(1)*1/3+beta4(2)*a2(1)*1/3+beta4(3)*a3(1)*1/3), (beta4(1)*a1(2)*1/3+beta4(2)*a2(2)*1/3+beta4(3)*a3(2)*1/3), (beta4(1)*a1(3)*1/3+beta4(2)*a2(3)*1/3+beta4(3)*a3(3)*1/3)]'
beta2 = [(beta3(1)*a1(1)*1/3+beta3(2)*a2(1)*1/3+beta3(3)*a3(1)*1/3), (beta3(1)*a1(2)*1/3+beta3(2)*a2(2)*1/3+beta3(3)*a3(2)*1/3), (beta3(1)*a1(3)*1/3+beta3(2)*a2(3)*1/3+beta3(3)*a3(3)*1/3)]'
beta1 = [(beta2(1)*a1(1)*1/3+beta2(2)*a2(1)*1/3+beta2(3)*a3(1)*1/3), (beta2(1)*a1(2)*1/3+beta2(2)*a2(2)*1/3+beta2(3)*a3(2)*1/3), (beta2(1)*a1(3)*1/3+beta2(2)*a2(3)*1/3+beta2(3)*a3(3)*1/3)]'
beta=[beta1,beta2,beta3,beta4]
alpha'*beta
sum(alpha'*beta)
alpha'
alpha
sum(alpha)
alpha'*beta
P1 = alpha4(1)+alpha4(2)+alpha4(3)
P2=alpha1(1)*beta1(1)+alpha1(2)*beta1(2)+alpha1(3)*beta1(3)
P3=alpha2(1)*beta2(1)+alpha2(2)*beta2(2)+alpha2(3)*beta2(3)
P4=alpha3(1)*beta3(1)+alpha3(2)*beta3(2)+alpha3(3)*beta3(3)
zeta1(1,1)=alpha(1,1)*A(1,1)*1/3*beta(1,2)
zeta1(1,2)=alpha(1,1)*A(1,2)*1/3*beta(2,2)
zeta1(1,3)=alpha(1,1)*A(1,3)*1/3*beta(3,2)
zeta1(2,1)=alpha(2,1)*A(2,1)*1/3*beta(1,2)
zeta1(2,2)=alpha(2,1)*A(2,2)*1/3*beta(2,2)
zeta1(2,3)=alpha(2,1)*A(2,3)*1/3*beta(3,2)
zeta1(3,1)=alpha(3,1)*A(3,1)*1/3*beta(1,2)
zeta1(3,2)=alpha(3,1)*A(3,2)*1/3*beta(2,2)
zeta1(3,3)=alpha(3,1)*A(3,3)*1/3*beta(3,2)
zeta1_final=zeta1/P
P =P1
zeta1_final=zeta1/P
zeta2(1,1)=alpha(1,2)*A(1,1)*1/3*beta(1,3)
zeta2(1,2)=alpha(1,2)*A(1,2)*1/3*beta(2,3)
zeta2(1,3)=alpha(1,2)*A(1,3)*1/3*beta(3,3)
zeta2(2,1)=alpha(2,2)*A(2,1)*1/3*beta(1,3)
zeta2(2,2)=alpha(2,2)*A(2,2)*1/3*beta(2,3)
zeta2(2,3)=alpha(2,2)*A(2,3)*1/3*beta(3,3)
zeta2(3,1)=alpha(3,2)*A(3,1)*1/3*beta(1,3)
zeta2(3,2)=alpha(3,2)*A(3,2)*1/3*beta(2,3)
zeta2(3,3)=alpha(3,2)*A(3,3)*1/3*beta(3,3)
zeta2_final=zeta2/P
zeta3(1,1)=alpha(1,3)*A(1,1)*1/3*beta(1,4)
zeta3(1,2)=alpha(1,3)*A(1,2)*1/3*beta(2,4)
zeta3(1,3)=alpha(1,3)*A(1,3)*1/3*beta(3,4)
zeta3(2,1)=alpha(2,3)*A(2,1)*1/3*beta(1,4)
zeta3(2,2)=alpha(2,3)*A(2,2)*1/3*beta(2,4)
zeta3(2,3)=alpha(2,3)*A(2,3)*1/3*beta(3,4)
zeta3(3,1)=alpha(3,3)*A(3,1)*1/3*beta(1,4)
zeta3(3,2)=alpha(3,3)*A(3,2)*1/3*beta(2,4)
zeta3(3,3)=alpha(3,3)*A(3,3)*1/3*beta(3,4)
zeta3_final=zeta3/P
fi1=sum(zeta1_final')
fi2=sum(zeta2_final')
fi3=sum(zeta3_final')
Anew(1,1)=(zeta1_final(1,1)+zeta2_final(1,1)+zeta3_final(1,1))/(fi1(1)+fi2(1)+fi3(1))
Anew(1,2)=(zeta1_final(1,2)+zeta2_final(1,2)+zeta3_final(1,2))/(fi1(1)+fi2(1)+fi3(1))
Anew(1,3)=(zeta1_final(1,3)+zeta2_final(1,3)+zeta3_final(1,3))/(fi1(1)+fi2(1)+fi3(1))
Anew(2,1)=(zeta1_final(2,1)+zeta2_final(2,1)+zeta3_final(2,1))/(fi1(2)+fi2(2)+fi3(2))
Anew(2,2)=(zeta1_final(2,2)+zeta2_final(2,2)+zeta3_final(2,2))/(fi1(2)+fi2(2)+fi3(2))
Anew(2,3)=(zeta1_final(2,3)+zeta2_final(2,3)+zeta3_final(2,3))/(fi1(2)+fi2(2)+fi3(2))
Anew(3,1)=(zeta1_final(3,1)+zeta2_final(3,1)+zeta3_final(3,1))/(fi1(3)+fi2(3)+fi3(3))
Anew(3,2)=(zeta1_final(3,2)+zeta2_final(3,2)+zeta3_final(3,2))/(fi1(3)+fi2(3)+fi3(3))
Anew(3,3)=(zeta1_final(3,3)+zeta2_final(3,3)+zeta3_final(3,3))/(fi1(3)+fi2(3)+fi3(3))
A
fi1_alternativo(1)=alpha(1,1)*beta(1,1)/P
fi1_alternativo(2)=alpha(2,1)*beta(2,1)/P
fi1_alternativo(3)=alpha(3,1)*beta(3,1)/P
fi2_alternativo(1)=alpha(1,2)*beta(1,2)/P
fi2_alternativo(2)=alpha(2,2)*beta(2,2)/P
fi2_alternativo(3)=alpha(3,2)*beta(3,2)/P
fi3_alternativo(1)=alpha(1,3)*beta(1,3)/P
fi3_alternativo(2)=alpha(2,3)*beta(2,3)/P
fi3_alternativo(3)=alpha(3,3)*beta(3,3)/P
fi4(1)=alpha(1,4)*beta(1,4)/P
fi4(2)=alpha(2,4)*beta(2,4)/P
fi4(3)=alpha(3,4)*beta(3,4)/P
Bnew(1,1)=(fi1(1)+fi2(1)+fi3(1)+fi4(1))/(fi1(1)+fi2(1)+fi3(1)+fi4(1))
Bnew(1,2)=0/(fi1(1)+fi2(1)+fi3(1)+fi4(1))
Bnew(1,3)=0/(fi1(1)+fi2(1)+fi3(1)+fi4(1))
Bnew(2,3)=0/(fi1(1)+fi2(1)+fi3(1)+fi4(1))
Bnew(2,1)=(fi1(1)+fi2(1)+fi3(1)+fi4(1))/(fi1(1)+fi2(1)+fi3(1)+fi4(1))
Bnew(2,1)=(fi1(2)+fi2(2)+fi3(2)+fi4(2))/(fi1(2)+fi2(2)+fi3(2)+fi4(2))
Bnew(2,2)=0/(fi1(2)+fi2(2)+fi3(2)+fi4(2))
Bnew(2,3)=0/(fi1(2)+fi2(2)+fi3(2)+fi4(2))
Bnew(3,1)=(fi1(3)+fi2(3)+fi3(3)+fi4(3))/(fi1(3)+fi2(3)+fi3(3)+fi4(3))
Bnew(3,2)=0/(fi1(3)+fi2(3)+fi3(3)+fi4(3))
Bnew(3,3)=0/(fi1(3)+fi2(3)+fi3(3)+fi4(3))
